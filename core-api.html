<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>zip.js</title>
	<link rel="stylesheet" href="default.css">
	<link href="google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/css?family=Maven+Pro|Muli|Istok+Web" rel="stylesheet" type="text/css">
</head>

<body>
	<a href="https://github.com/gildas-lormeau/zip.js"><img style="position: absolute; top: 0; right: 0; border: 0;"
			src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
			alt="Fork me on GitHub" /></a>
	<div id="container">
		<h1>
			<a href="index.html">zip.js</a> <span class="small"></span>
		</h1>

		<div class="description">
			Core API
			<hr>
		</div>
		<h2>Contents</h2>
		<ol>
			<li><a href="#configuration">Configuration</a></li>
			<li><a href="#io">I/O</a></li>
			<li><a href="#zip-reading">Zip reading</a></li>
			<li><a href="#zip-reading-example">Zip reading example</a></li>
			<li><a href="#zip-writing">Zip writing</a></li>
			<li><a href="#zip-writing-example">Zip writing example</a></li>
			<li><a href="#full-example">Full example</a></li>
			<li><a href="#alternative-codecs">Alternative DEFLATE implementations</a></li>
		</ol>
		<hr>

		<h2 id="configuration">Configuration</h2>
		<p>You can call the function <code>zip.configure</code> in order to configure zip.js. It accepts a configuration
			object as parameter with these optional properties:</p>
		<dl>
			<dt><code>useWebWorkers (booolean)</code></dt>
			<dd>Enables the use of <a href="https://www.w3.org/TR/workers/">Web workers</a> to compress and uncompress
				data in non-blocking background processes. The default value is <code>true</code>. You must also include
				<code>deflate.js</code> and/or <code>inflate.js</code> and/or <code>crypto.js</code> in the web page if
				you set it to <code>false</code>
			</dd>
		</dl>
		<dl>
			<dt><code>maxWorkers (number)</code></dt>
			<dd>Number of Web workers used simultaneously to process data. The default value is the number of logical
				cores returned by the attribute
				<code><a href="https://html.spec.whatwg.org/multipage/workers.html#navigator.hardwareconcurrency">navigator.hardwareConcurrency</a></code>
				or <code>2</code> if <code>navigator</code> is <code>undefined</code>.
			</dd>
		</dl>
		<dl>
			<dt><code>workerScriptsPath (string)</code></dt>
			<dd>URL to the directory containing the default worker scripts (<code>z-worker.js</code>,
				<code>deflate.js</code>, and <code>inflate.js</code>). If a relative URL is specified, it is resolved
				against the page's base URL (usually the URL of the web page importing zip.js). By default, the worker
				scripts are loaded from the directory of the page's base URL.
			</dd>
		</dl>
		<dl>
			<dt><code>workerScripts (Object)</code></dt>
			<dd>Advanced option used as an alternative to <code>workerScriptsPath</code> to explicitly control which
				scripts are loaded in the web worker. It allows using alternative deflate implementations, or
				concatenating worker scripts. The properties <code>deflate</code> and <code>inflate</code> must
				specify arrays of URLs to import the deflate/inflate scripts, respectively. All the URLs are resolved
				relative to the page's base URL. Scripts in the array are executed in order, and the first one should be
				<code>z-worker.js</code>, which is used to start the worker. If only deflation or inflation is used in
				your application, the unused <code>workerScripts.deflate/inflate</code> property can be omitted, or
				the unused <code>deflate.js</code>/<code>inflate.js</code> file can be removed from the array. The
				</code>crypto.js</code> file can also be ommitted if you do not use encryption. Example:
				<pre><code class="prettyprint">zip.configure({
  workerScripts: {
    deflate: [
      "&lt;library path&gt;/z-worker.js", "&lt;library path&gt;/deflate.js", "&lt;library path&gt;/crypto.js"],
    inflate: [
      "&lt;library path&gt;/z-worker.js", "&lt;library path&gt;/inflate.js", "&lt;library path&gt;/crypto.js"]
  }
});</code></pre>
			</dd>
		</dl>

		<h2 id="io">I/O</h2>
		<h3>Reader and Writer constructors</h3>
		<p>
			<code>zip.js</code> can handle multiple types of data thanks to a generic API. This feature is based on 2
			abstract constructors: <code><a href="#zip-reading">zip.Reader</a></code> and
			<code><a href="#zip-writer">zip.Writer</a></code>. <code><a href="#zip-reading">zip.Reader</a></code>
			constructors help to read data from a file and <code><a href="#zip-writer">zip.Writer</a></code>
			constructors help to write data into a file.
		</p>
		<p>
			For example, if you need to read a zip and store its file into a variable, you must use a
			<code><a href="#zip-reading">zip.Reader</a></code> object to read the compressed zip data. You must also use
			a <code><a href="#zip-writer">zip.Writer</a></code> object to write uncompressed file data into the
			variable.
		</p>

		<h3 id="zip-reading">Reader constructors</h3>

		<p>
			<code>string</code> reader constructor
		</p>
		<pre><code class="prettyprint">zip.TextReader(text)</code></pre>
		<p>Parameters:</p>
		<dl>
			<dt><code>text (string)</code></dt>
			<dd>The <code>string</code> to read</dd>
		</dl>
		<br>
		<p>
			<code><a href="https://www.w3.org/TR/FileAPI/#dfn-Blob">Blob</a></code> object reader constructor
		</p>
		<pre><code class="prettyprint">zip.BlobReader(blob)</code></pre>
		<p>Parameters:</p>
		<dl>
			<dt><code>blob (<a href="https://www.w3.org/TR/FileAPI/#dfn-Blob">Blob</a>)</code></dt>
			<dd>The <code><a href="https://www.w3.org/TR/FileAPI/#dfn-Blob">Blob</a></code> object to read</dd>
		</dl>
		<br>
		<p>
			Data URI reader constructor
		</p>
		<pre><code class="prettyprint">zip.Data64URIReader(dataURI)</code></pre>
		<p>Parameters:</p>
		<dl>
			<dt><code>dataURI (string)</code></dt>
			<dd>The data URI to read</dd>
		</dl>
		<br>
		<p>
			HTTP content reader constructor
		</p>
		<pre><code class="prettyprint">zip.HttpReader(URL)</code></pre>
		<p>Parameters:</p>
		<dl>
			<dt><code>URL (string)</code></dt>
			<dd>The URL of the content to read</dd>
		</dl>
		<br>
		<p>
			HTTP content reader using &quot;Range&quot; request header constructor
		</p>
		<pre><code class="prettyprint">zip.HttpRangeReader(URL)</code></pre>
		<p>Parameters:</p>
		<dl>
			<dt><code>URL (string)</code></dt>
			<dd>The URL of the content to read</dd>
		</dl>

		<h3>Reader members (used internally)</h3>
		<p>Attributes:</p>
		<dl>
			<dt><code>size (number)</code></dt>
			<dd>The uncompressed data byte size</dd>
		</dl>
		<p>Methods:</p>
		<pre><code class="prettyprint">zip.Reader#init()</code></pre>
		<p>Initialize the <code><a href="#zip-reading">zip.Reader</a></code> object.</p>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with <code>undefined</code> as resolved value</dd>
		</dl>
		<pre><code class="prettyprint">zip.Reader#readUint8Array(index, length])</code></pre>
		<p>Extract an
			<code><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-typedarray-objects">UInt8Array</a></code>
			object
			beginning at <code>index</code> location through the specified <code>length</code>.
		</p>
		<p>Parameters:</p>
		<dl>
			<dt><code>index (number)</code></dt>
			<dd>The beginning index</dd>
			<dt><code>length (number)</code></dt>
			<dd>The
				<code><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-typedarray-objects">UInt8Array</a></code>
				object
				length
			</dd>
		</dl>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with the
				<code><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-typedarray-objects">UInt8Array</a></code>
				object
				as resolved value
			</dd>
		</dl>
		<h3 id="zip-writer">Writer constructors</h3>
		<p>
			<code>string</code> writer constructor
		</p>
		<pre><code class="prettyprint">zip.TextWriter()</code></pre>
		<br>
		<p>
			<code><a href="https://www.w3.org/TR/FileAPI/#dfn-Blob">Blob</a></code> object writer constructor
		</p>
		<pre><code class="prettyprint">zip.BlobWriter()</code></pre>
		<br>
		<p>
			Data URI writer constructor
		</p>
		<pre><code class="prettyprint">zip.Data64URIWriter([mimeString])</code></pre>
		<p>Parameters:</p>
		<dl>
			<dt><code>mimeString (string)</code></dt>
			<dd>the MIME type of the data to write</dd>
		</dl>

		<h3>Writer members (used internally)</h3>
		<p>Methods:</p>
		<pre><code class="prettyprint">zip.Writer#init()</code></pre>
		<p>Initialize the <code><a href="#zip-writer">zip.Writer</a></code> object.</p>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with <code>undefined</code> as resolved value</dd>
		</dl>
		<pre><code class="prettyprint">zip.Writer#writeUint8Array(array)</code></pre>
		<p>Write an
			<code><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-typedarray-objects">UInt8Array</a></code>
			object at
			the current index.
		</p>
		<p>Parameters:</p>
		<dl>
			<dt><code>array (<a href="https://www.ecma-international.org/ecma-262/6.0/#sec-typedarray-objects">UInt8Array</a>)</code>
			</dt>
			<dd>The
				<code><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-typedarray-objects">UInt8Array</a></code>
				to
				write
			</dd>
		</dl>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with <code>undefined</code> as resolved value</dd>
		</dl>
		<pre><code class="prettyprint">zip.Writer#getData()</code></pre>
		<p>Get written data (returned type depends on <code><a href="#zip-reading">zip.Reader</a></code> constructor
			used)</p>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with the data as resolved value</dd>
		</dl>

		<h2 id="zip-reading">Zip reading</h2>
		<h3>Constructor</h3>
		<pre><code class="prettyprint">zip.ZipReader(reader)</code></pre>
		<p>
			Create a <code><a href="#zip-reading-proto">ZipReader</a></code> object. A
			<code><a href="#zip-reading-proto">ZipReader</a></code> object helps to read the zipped content.
		</p>
		<p>Parameters:</p>
		<dl>
			<dt><code>reader (<a href="#zip-reading">zip.Reader</a>)</code></dt>
			<dd>the <code><a href="#zip-reading">zip.Reader</a></code> object used to read input data</dd>
		</dl>

		<h3 id="zip-reading-proto">Zip entries listing</h3>
		<pre><code class="prettyprint">ZipReader#getEntries()</code></pre>
		<p>
			Get all entries from a zip.
		</p>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with the Array of <code><a href="#zip-entry">Entry</a></code> object as resolved value</dd>
		</dl>

		<h3>Zip entry data reading</h3>
		<pre id="zip-entry"><code class="prettyprint">Entry()</code></pre>
		<p>
			Constructor representing a zip file entry.
		</p>
		<p>Attributes:</p>
		<dl>
			<dt><code>filename (string)</code></dt>
			<dd>file name</dd>
			<dt><code>rawFilename (UInt8Array)</code></dt>
			<dd>file name in binary</dd>
			<dt><code>directory (boolean)</code></dt>
			<dd><code>true</code> if the entry is a directory</dd>
			<dt><code>compressedSize (number)</code></dt>
			<dd>compressed data size</dd>
			<dt><code>uncompressedSize (number)</code></dt>
			<dd>uncompressed data size</dd>
			<dt><code>lastModDate (Date)</code></dt>
			<dd>last modification date</dd>
			<dt><code>lastModDateRaw (number)</code></dt>
			<dd>last modification date in raw format (MS-DOS)</dd>
			<dt><code>comment (string)</code></dt>
			<dd>file comment</dd>
			<dt><code>rawComment (UInt8Array)</code></dt>
			<dd>file comment in binary</dd>
			<dt><code>crc32 (number)</code></dt>
			<dd>uncompressed data checksum</dd>
			<dt><code>extraField (Map)</code></dt>
			<dd>Map of extra field data where the key <code>(number)</code> is the type of the extra field and the value is a <code>UInt8Array</code></dd>
			<dt><code>rawExtraField (UInt8Array)</code></dt>
			<dd>extra field in binary</dd>
		</dl>
		<p>Methods:</p>
		<pre><code class="prettyprint">Entry#getData(writer [, options])</code></pre>
		<p>
			Get the data of a zip entry.
		</p>
		<p>Parameters:</p>
		<dl>
			<dt><code>writer (<a href="#zip-writer">zip.Writer</a>)</code></dt>
			<dd><code><a href="#zip-writer">zip.Writer</a></code> object used to write output data</dd>
			<dt><code>options (Object)</code></dt>
			<dd>optional properties:
				<dl>
					<dt><code>onprogress (Function)</code></dt>
					<dd>function tracking the task progress and having as parameters an <code>index (number)</code>
						value and a <code>max (number)</code> value</dd>
					<dt><code>checkSignature (boolean)</code></dt>
					<dd>boolean value specifying if the signature of the file should be verified (<code>false</code> by
						default)</dd>
					<dt><code>password (string)</code></dt>
					<dd>password used to decrypt the file encrypted with AES-256 (empty by default)</dd>
				</dl>
			</dd>
		</dl>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with the output data (returned type depends on
				<code><a href="#zip-writer">zip.Writer</a></code> constructor used) as resolved value
			</dd>
		</dl>

		<h3>Zip closing</h3>
		<pre><code class="prettyprint">ZipReader#close()</code></pre>
		<p>
			Close the opened zip file.
		</p>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with <code>undefined</code> as resolved value</dd>
		</dl>

		<h2 id="zip-reading-example">Zip reading example</h2>
		<h3>Read a zip from a Blob/File object</h3>
		<pre><code class="prettyprint">// create a BlobReader to read with a ZipReader the zip from a Blob object
const reader = new zip.ZipReader(new zip.BlobReader(blob));

// get all entries from the zip
const entries = await reader.getEntries();
if (entries.length) {

  // get first entry content as text by using a TextWriter
  const text = await entries[0].getData(new zip.TextWriter(), { onprogress: (index, max) => {
	// onprogress callback
  }});
  // text contains the entry data as a String
  console.log(text);

}

// close the ZipReader
await reader.close();</code></pre>

		<h2 id="zip-writing">Zip writing</h2>
		<h3>Constructor</h3>
		<pre><code class="prettyprint">zip.ZipWriter(writer [, options])</code></pre>
		<p>
			Create a <code><a href="#zip-writer-proto">ZipWriter</a></code> object.
		</p>
		<p>Parameters:</p>
		<dl>
			<dt><code>writer (<a href="#zip-writer">zip.Writer</a>)</code></dt>
			<dd>the <code><a href="#zip-writer">zip.Writer</a></code> object used to write output data</dd>
			<dt><code>options (Object)</code></dt>
			<dd>optional properties:
				<dl>
					<dt><code>zip64 (boolean)</code></dt>
					<dd>force the file to be written in zip64</dd>
				</dl>
			</dd>
		</dl>

		<h3 id="zip-writer-proto">Zip entry writing</h3>
		<pre><code class="prettyprint">ZipWriter#add(name , reader [, options])</code></pre>
		<p>
			Add a new entry into the zip.
		</p>
		<p>Parameters:</p>
		<dl>
			<dt><code>name (string)</code></dt>
			<dd>entry file name</dd>
			<dt><code>reader (<a href="#zip-reading">zip.Reader</a>)</code></dt>
			<dd>the <code><a href="#zip-reading">zip.Reader</a></code> object used to read entry data to add -
				null for directory entry</dd>
			<dt><code>options (Object)</code></dt>
			<dd>optional properties:
				<dl>
					<dt><code>onprogress (Function)</code></dt>
					<dd>function tracking the task progress and having as parameters an <code>index (number)</code>
						value and a <code>max (number)</code> value</dd>
					<dt><code>directory (boolean)</code></dt>
					<dd><code>true</code> if the entry is a directory</dd>
					<dt><code>level (number)</code></dt>
					<dd>compression level from <code>0</code> to <code>9</code></dd>
					<dt><code>bufferedWrite (boolean)</code></dt>
					<dd><code>true</code> to explicitely allow calling <code>ZipWriter#add</code> multiple times in parallel (<code>false</code> by default)
					</dd>
					<dt><code>comment (string)</code></dt>
					<dd>file comment</dd>
					<dt><code>lastModDate (Date)</code></dt>
					<dd>last modification date</dd>
					<dt><code>version (number)</code></dt>
					<dd>zip version</dd>
					<dt><code>password (string)</code></dt>
					<dd>password used to encrypt the file with AES-256 (empty by default)</dd>
					<dt><code>zip64 (boolean)</code></dt>
					<dd>force the file entry to be written in zip64 (<code>false</code> by default)</dd>
					<dt><code>extraField (Map)</code></dt>
					<dd>Map of extra field data where the key <code>(number)</code> is the type of the extra field and the value is a <code>UInt8Array</code>.</dd>
				</dl>
			</dd>
		</dl>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with <code>undefined</code> as resolved value</dd>
		</dl>

		<h3>Zip closing</h3>
		<pre><code class="prettyprint">ZipWriter#close([comment])</code></pre>
		<p>
			Close the opened zip and terminate the associated web worker(s).
		</p>
		<p>Parameters:</p>
		<dl>
			<dt><code>comment (UInt8Array)</code></dt>
			<dd>a comment to add at the end of the zip file</dd>
		</dl>
		<p>Returns:</p>
		<dl>
			<dt><code>Promise</code></dt>
			<dd>A promise with the value of <code>writer.getData()</code> as resolved value</dd>
		</dl>

		<h2 id="zip-writing-example">Zip writing example</h2>
		<h3>Write a zip into a Blob object</h3>
		<pre><code class="prettyprint">// use a BlobWriter to store with a ZipWriter the zip into a Blob object
const blobWriter = new zip.BlobWriter();
const writer = new zip.ZipWriter(blobWriter);

// use a TextReader to read the String to add
await writer.add("filename.txt", new zip.TextReader("test!"));

// close the ZipReader
await writer.close();

// get the zip file as a Blob
const blob = await blobWriter.getData();</code></pre>
		<h2 id="full-example">Full example</h2>
		<pre><code class="prettyprint">// create the inputBlob object storing the data to compress
const inputBlob = new Blob(["Lorem ipsum dolor sit amet, consectetuer adipiscing elit..."], { type: "text/plain" });

// use a BlobWriter object to write the zipped data into a Blob object
const blobWriter = new zip.BlobWriter("application/zip");

// use a ZipWriter object to write zipped data
const zipWriter = new zip.ZipWriter(blobWriter);

// use a BlobReader object to read the data stored into inputBlob
const inputBlobReader = new zip.BlobReader(inputBlob)

// add the Blob object into the zip named as test.txt
await zipWriter.add("test.txt", inputBlobReader);

// close the ZipWriter object
await zipWriter.close();

// store zipped data into outputBlob
const outputBlob = await blobWriter.getData();

// use a zip.BlobReader object to read zipped data stored into the outputBlob variable
const ouputBlobReader = new zip.BlobReader(outputBlob);

// use a ZipWriter object to read the zipped data
const zipReader = new zip.ZipReader(ouputBlobReader);

// get entries from the zip file
const entries = await zipReader.getEntries();

// get the first entry
const firstEntry = entries[0];

// use a BlobWriter object to write the unzipped data into a Blob object
const outputBlobWriter = new zip.BlobWriter("text/plain");

// get data from the first file
const data = await entries[0].getData(outputBlobWriter);

// log the data
console.log(data);

// close the ZipReader object
await zipReader.close();</code></pre>

		<h2 id="alternative-codecs">Alternative DEFLATE implementations</h2>
		<p>Alternative DEFLATE implementations can be used with zip.js in favor of better performance and/or better
			compliance. Currently only pako is supported. In order to use them, you need to specify the
			<code>workerScripts</code> configuration property instead of <code>workerScriptsPath</code>, see below.
		</p>
		<ul>
			<li>
				<h3>pako</h3>
				<p><a href="https://github.com/nodeca/pako">Pako</a> is a handwritten JavaScript port of zlib. Its
					compatibility and performance is believed to be good. To use pako with web workers, configure zip.js
					as follows:
				</p>
				<pre><code class="prettyprint">zip.configure({
  workerScripts: {
    deflate: ["&lt;library path&gt;/z-worker-pako.js", "&lt;library path&gt;/pako.min.js"],
    inflate: ["&lt;library path&gt;/z-worker-pako.js", "&lt;library path&gt;/pako.min.js"]
  }
});</code></pre>
				<p>Pako also has separate js files for deflating/inflating, you can also use them instead of
					<code>pako.min.js</code>:
				</p>
				<pre><code class="prettyprint">zip.configure({
  workerScripts: {
    deflate: ["&lt;library path&gt;/z-worker-pako.js", "&lt;library path&gt;/pako_deflate.min.js"],
    inflate: ["&lt;library path&gt;/z-worker-pako.js", "&lt;library path&gt;/pako_inflate.min.js"]
  }
});</code></pre>
				<p><code>&lt;library path&gt;/z-worker-pako.js</code> is the entry script for pako. This file can
					be found in the <code>/dist/</code> folder. Note that <code>pako.min.js</code> etc. are parts of
					pako project, and are not provided by zip.js. You can find them <a
						href="https://github.com/nodeca/pako/tree/master/dist">here</a>.
				</p>
			</li>
		</ul>

	</div>
	<script type="text/javascript" src="google-code-prettify/prettify.js"></script>
	<script type="text/javascript">
		prettyPrint();
	</script>
</body>

</html>
